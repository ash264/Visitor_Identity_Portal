{%extends 'visitor/base.html'%}
{%load static%}

{%block content%}
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Visitor Form</title>
    <style type="text/css">
        body { font-family: Helvetica, sans-serif; }
        h2, h3 { margin-top:0; }
        form { margin-top: 15px; }
        form > input { margin-right: 15px; }
        #results { float:right; margin:20px; padding:20px; border:1px solid; background:#ccc; }
    </style>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>
    <div class="container jumbotron" style="width: 60%;">
        <form name="myform" class="form-group" method="POST" action="{%url 'visitor:register'%}">
            <h2 style="text-align: center; font-weight: bold;"><i class="fas fa-id-card"></i>&ensp;&ensp;Visitor Registration Form</h2>

            <div class="row" style="margin-top: 30px;">
                <div class="col-sm-6">
                    <div id="my_camera"></div>
    
                    <!-- First, include the Webcam.js JavaScript Library -->
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
                    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.25/webcam.min.js"></script>
                    
                    <!-- Configure a few settings and attach camera -->
                    <script language="JavaScript">
                        Webcam.set({
                            width: 320,
                            height: 240,
                            image_format: 'jpeg',
                            jpeg_quality: 90
                        });
                    </script>
                                    
                
                    <!-- A button for taking snaps -->
                    <div class="container">
                            {%csrf_token%}
                            <button type="button" class="btn btn-default btn-sm" onClick="setup(); $(this).hide().next().show();">
                              <span class="glyphicon glyphicon-camera"></span> Access Camera
                            </button>

                            <input type="button"  class="btn btn-primary center" value="Take Snapshot" onClick="take_snapshot()" style="display:none; margin-top: 0px ;width: 80%"><br><br>
                            Image: <input type="text"  id="myPhoto" name="pic"><br><br>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div id="results" style="margin-top: 0px; padding-top: 0px;">Your captured image will appear here...</div>
                </div>
                <div class="col-sm-12"></div>
                <div class="col-sm-12">
                    <label for="inputname">Name of Visitor</label>
                    <input type="text" name="name" class="form-control" placeholder="Name of Visitor">
                </div>
                <div class="col-sm-12">
                    <label for="inputname">S/D/W/O</label>
                    <input type="text" name="name_2" class="form-control" placeholder="S/D/W/O">
                </div>
                
                <div class="col-sm-12">
                    <label for="dob">Address</label>
                    <input type="text" name="address" class="form-control" id="datepicker1" placeholder="Address">
                </div>
                
                <div class="col-sm-6">
                    <label for="programme">ID number</label>
                    <input type="text"  name="id_no" class="form-control" placeholder="ID number">
                </div>
                
                <div class="col-sm-6">
                    <label for="blood_group">ID Type</label>
                    <input type="text" name="id_type" class="form-control" placeholder="ID Type">
                </div>
                
                <div class="col-sm-6">
                    <label for="issue">Mobile Number</label>
                    <input type="text" name="mob" class="form-control" id="datepicker2" placeholder="Mobile">
                </div>
                <div class="col-sm-6">
                    <label for="issue">Email ID</label>
                    <input type="text" name="email" class="form-control" id="datepicker2" placeholder="Mobile">
                </div>
                <div class="col-sm-6">
                    <label for="valid">Vehicle Number</label>
                    <input type="text" name="veh" class="form-control" id="datepicker" placeholder="Vehicle Number">
                </div>
                <div class="col-sm-6">
                    <label for="valid">Purpose of Visit</label>
                    <input type="text" name="purpose" class="form-control" id="datepicker" placeholder="Purpose of Visit">
                </div>
                <div class="col-sm-6">
                    <label for="valid">Destination</label>
                    <input type="text" name="dest" class="form-control" id="datepicker" placeholder="Destination">
                </div>

                <div class="col-sm-12"  style="text-align: center;margin-top: 30px;">
                    <button type="submit" class="btn btn-primary" style="width: 50%;">Submit</button>
                </div>
               
            </div>
        </form>
    </div>
    <!-- First, include the Webcam.js JavaScript Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.25/webcam.min.js"></script>
    
    <!-- Configure a few settings and attach camera -->
    <script language="JavaScript">
        Webcam.set({
            width: 320,
            height: 240,
            image_format: 'jpeg',
            jpeg_quality: 90
        });
    </script>
    
    <!-- Code to handle taking the snapshot and displaying it locally -->
    <script language="JavaScript">
        function setup() {
            Webcam.reset();
            Webcam.attach( '#my_camera' );
        }

        // *****
        // *****
        
        function take_snapshot() {
            // take snapshot and get image data
            Webcam.snap( function(data_uri) {
                // display results in page
                document.getElementById("myPhoto").value=data_uri;
                document.getElementById('results').innerHTML = 
                    // alert(data_uri);
                    '<h3 style="text-align:center; margin-top:0px;padding:0px;">Here is your image:</h3>' + 
                    '<img src="'+data_uri+'" id="capture"/>' ;
            } );    
        }
    </script>
</body>
</html>
{% endblock content%}